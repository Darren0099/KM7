<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peta Digital Rumah Aman dan Instansi Pendukung</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">

    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places&callback=initMap" async defer></script>
    <style>
        :where([class^="ri-"])::before {
            content: "\f3c2";
        }
        #map {
            height: 100%;
            width: 100%;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#dc2626',
                        secondary: '#059669'
                    },
                    borderRadius: {
                        'none': '0px',
                        'sm': '4px',
                        DEFAULT: '8px',
                        'md': '12px',
                        'lg': '16px',
                        'xl': '20px',
                        '2xl': '24px',
                        '3xl': '32px',
                        'full': '9999px',
                        'button': '8px'
                    }
                }
            }
        }

        // Custom icons for different location types
        const customIcons = {
            'safehouse': {
                url: 'https://maps.google.com/mapfiles/ms/icons/red-dot.png',
                scaledSize: new google.maps.Size(32, 32)
            },
            'legal': {
                url: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png',
                scaledSize: new google.maps.Size(32, 32)
            },
            'counseling': {
                url: 'https://maps.google.com/mapfiles/ms/icons/green-dot.png',
                scaledSize: new google.maps.Size(32, 32)
            }
        };

        // Sample locations data
        const locations = [
            {
                id: 1,
                name: "DP3APM Kota Palembang",
                address: "Jl. Demang Lebar Daun No.2B, Palembang",
                type: "safehouse",
                hours: "08:00 - 16:00",
                distance: "1.5 km",
                phone: "(0711) 357007",
                position: { lat: -2.991035, lng: 104.756418 }
            },
            {
                id: 2,
                name: "Polresta Palembang",
                address: "Jl. Merdeka No.11, Bukit Kecil, Palembang",
                type: "legal",
                hours: "24 Jam",
                distance: "2.3 km",
                phone: "110",
                position: { lat: -2.983452, lng: 104.753689 }
            },
            {
                id: 3,
                name: "BDK Palembang Kemenag RI",
                address: "Jl. Demang Lebar Daun, Ilir Barat I, Palembang",
                type: "counseling",
                hours: "08:00 - 16:00",
                distance: "3.1 km",
                phone: "(0711) 362345",
                position: { lat: -2.989123, lng: 104.759876 }
            }
        ];

        let map;
        let markers = [];
        let userMarker;
        let userPosition;

        function initMap() {
            // Default center (Palembang)
            const defaultCenter = { lat: -2.991035, lng: 104.756418 };
            
            // Initialize map
            map = new google.maps.Map(document.getElementById('map'), {
                center: defaultCenter,
                zoom: 14,
                mapTypeControl: false,
                streetViewControl: false,
                fullscreenControl: false
            });

            // Add markers for sample locations
            locations.forEach(location => {
                const marker = new google.maps.Marker({
                    position: location.position,
                    map: map,
                    icon: customIcons[location.type],
                    title: location.name
                });

                // Add click event to show info window
                marker.addListener('click', () => {
                    showLocationPopup(location);
                });

                markers.push(marker);
            });

            // Add event listener for "Lokasi Saya" button
            document.getElementById('btn-lokasi-saya').addEventListener('click', () => {
    getCurrentLocation();
});


            // Add zoom controls
            document.querySelector('.bg-white.p-3.rounded-lg:nth-child(1)').addEventListener('click', () => {
                map.setZoom(map.getZoom() + 1);
            });

            document.querySelector('.bg-white.p-3.rounded-lg:nth-child(2)').addEventListener('click', () => {
                map.setZoom(map.getZoom() - 1);
            });

            // Add center to current location control
            document.querySelector('.bg-white.p-3.rounded-lg:nth-child(3)').addEventListener('click', () => {
                if (userPosition) {
                    map.panTo(userPosition);
                } else {
                    getCurrentLocation();
                }
            });
        }

        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userPosition = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };

                        // Remove previous user marker if exists
                        if (userMarker) {
                            userMarker.setMap(null);
                        }

                        // Add user marker with blue dot icon
                        userMarker = new google.maps.Marker({
                            position: userPosition,
                            map: map,
                            icon: {
                                url: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png',
                                scaledSize: new google.maps.Size(32, 32)
                            },
                            title: 'Lokasi Anda'
                        });

                        // Center map on user's location
                        map.panTo(userPosition);

                        // Show success message
                        alert('Lokasi Anda berhasil ditemukan dan ditandai di peta dengan titik biru.');
                    },
                    (error) => {
                        // Handle errors
                        let errorMessage;
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage = "Akses lokasi ditolak. Silakan izinkan akses lokasi di pengaturan browser Anda.";
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage = "Informasi lokasi tidak tersedia.";
                                break;
                            case error.TIMEOUT:
                                errorMessage = "Permintaan lokasi melebihi batas waktu.";
                                break;
                            case error.UNKNOWN_ERROR:
                                errorMessage = "Terjadi kesalahan yang tidak diketahui.";
                                break;
                        }
                        alert(errorMessage);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 5000,
                        maximumAge: 0
                    }
                );
            } else {
                alert("Browser Anda tidak mendukung geolokasi.");
            }
        }

        function showLocationPopup(location) {
            const popup = document.getElementById('location-popup');
            
            // Update popup content
            popup.querySelector('h3').textContent = location.name;
            popup.querySelector('p.text-sm.text-gray-600').textContent = location.address;
            popup.querySelectorAll('p.text-sm.text-gray-600')[1].textContent = location.hours;
            popup.querySelectorAll('p.text-sm.text-gray-600')[2].textContent = location.phone;
            popup.querySelectorAll('p.text-sm.text-gray-600')[3].textContent = location.distance + ' â€¢ 5 menit berkendara';
            
            // Update icon color based on type
            const iconElement = popup.querySelector('.w-4.h-4');
            iconElement.className = 'w-4 h-4 rounded-full flex-shrink-0';
            
            if (location.type === 'safehouse') {
                iconElement.classList.add('bg-primary');
            } else if (location.type === 'legal') {
                iconElement.classList.add('bg-blue-600');
            } else if (location.type === 'counseling') {
                iconElement.classList.add('bg-secondary');
            }
            
            // Show popup
            popup.classList.remove('hidden');
            
            // Center map on this location
            map.panTo(location.position);
        }
    </script>
</head>
<body class="bg-gray-50 font-sans">
   
    <main class="min-h-screen">
        <div class="bg-white py-8 border-b border-gray-100">
            <div class="px-6">
                <div class="text-center max-w-4xl mx-auto">
                    <h1 class="text-4xl font-bold text-gray-900 mb-4">Peta Digital Rumah Aman dan Instansi Pendukung</h1>
                    <p class="text-lg text-gray-600">Temukan lokasi rumah aman, lembaga bantuan hukum, dan layanan konseling terdekat dengan informasi lengkap jam operasional dan kontak darurat</p>
                </div>
            </div>
        </div>
        <div class="flex h-screen">
            <div class="w-96 bg-white border-r border-gray-200 flex flex-col">
                <div class="p-6 border-b border-gray-100">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">Filter Pencarian</h2>
                    <div class="space-y-6">
                        
                        <div>
                            <label class="text-sm font-medium text-gray-700 mb-3 block">Wilayah</label>
                            <div class="relative">
                                <select class="w-full p-3 border border-gray-300 rounded-lg text-gray-700 bg-white pr-8">
                                    <option>Semua Wilayah</option>
                                    <option>Jakarta Pusat</option>
                                    <option>Jakarta Selatan</option>
                                    <option>Jakarta Barat</option>
                                    <option>Jakarta Timur</option>
                                    <option>Jakarta Utara</option>
                                    <option>Bogor</option>
                                    <option>Depok</option>
                                    <option>Tangerang</option>
                                    <option>Bekasi</option>
                                </select>
                                <div class="absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 flex items-center justify-center pointer-events-none">
                                    <i class="ri-arrow-down-s-line text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-700 mb-3 block">Radius Pencarian</label>
                            <div class="px-2">
                                <input type="range" min="1" max="50" value="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                <div class="flex justify-between text-xs text-gray-500 mt-2">
                                    <span>1 km</span>
                                    <span id="radius-value">10 km</span>
                                    <span>50 km</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-700 mb-3 block">Pencarian</label>
                            <div class="relative">
                                <input type="text" placeholder="Cari berdasarkan nama atau alamat..." class="w-full p-3 pl-10 border border-gray-300 rounded-lg text-sm">
                                <div class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 flex items-center justify-center">
                                    <i class="ri-search-line text-gray-400 text-sm"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Lokasi Terdekat</h3>
                    <div class="space-y-4">
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer bg-white" onclick="showLocationPopup(locations[0])">
                            <div class="flex items-start space-x-3">
                                <div class="w-3 h-3 bg-primary rounded-full mt-2 flex-shrink-0"></div>
                                <div class="flex-1">
                                    <h4 class="font-medium text-gray-900">DP3APM Kota Palembang</h4>
                                    <p class="text-sm text-gray-600 mt-1">Jl. Demang Lebar Daun No.2B, Palembang</p>
                                    <div class="flex items-center space-x-4 mt-2 text-xs text-gray-500">
                                        <span class="flex items-center space-x-1">
                                            <div class="w-3 h-3 flex items-center justify-center">
                                                <i class="ri-time-line text-xs"></i>
                                            </div>
                                            <span>08:00 - 16:00</span>
                                        </span>
                                        <span class="flex items-center space-x-1">
                                            <div class="w-3 h-3 flex items-center justify-center">
                                                <i class="ri-map-pin-line text-xs"></i>
                                            </div>
                                            <span>1.5 km</span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer bg-white" onclick="showLocationPopup(locations[1])">
                            <div class="flex items-start space-x-3">
                                <div class="w-3 h-3 bg-blue-600 rounded-full mt-2 flex-shrink-0"></div>
                                <div class="flex-1">
                                    <h4 class="font-medium text-gray-900">Polresta Palembang</h4>
                                    <p class="text-sm text-gray-600 mt-1">Jl. Merdeka No.11, Bukit Kecil, Palembang</p>
                                    <div class="flex items-center space-x-4 mt-2 text-xs text-gray-500">
                                        <span class="flex items-center space-x-1">
                                            <div class="w-3 h-3 flex items-center justify-center">
                                                <i class="ri-time-line text-xs"></i>
                                            </div>
                                            <span>24 Jam</span>
                                        </span>
                                        <span class="flex items-center space-x-1">
                                            <div class="w-3 h-3 flex items-center justify-center">
                                                <i class="ri-map-pin-line text-xs"></i>
                                            </div>
                                            <span>2.3 km</span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer bg-white" onclick="showLocationPopup(locations[2])">
                            <div class="flex items-start space-x-3">
                                <div class="w-3 h-3 bg-secondary rounded-full mt-2 flex-shrink-0"></div>
                                <div class="flex-1">
                                    <h4 class="font-medium text-gray-900">BDK Palembang Kemenag RI</h4>
                                    <p class="text-sm text-gray-600 mt-1">Jl. Demang Lebar Daun, Ilir Barat I, Palembang</p>
                                    <div class="flex items-center space-x-4 mt-2 text-xs text-gray-500">
                                        <span class="flex items-center space-x-1">
                                            <div class="w-3 h-3 flex items-center justify-center">
                                                <i class="ri-time-line text-xs"></i>
                                            </div>
                                            <span>08:00 - 16:00</span>
                                        </span>
                                        <span class="flex items-center space-x-1">
                                            <div class="w-3 h-3 flex items-center justify-center">
                                                <i class="ri-map-pin-line text-xs"></i>
                                            </div>
                                            <span>3.1 km</span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex-1 relative">
                <div style="width: 100%; max-width: 600px; margin: auto;">
  <iframe 
    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d249.02537910939677!2d104.72403214401585!3d-2.9846903755496688!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e3b759239be7fa3%3A0x5d9705d6e7eca407!2sDinas%20Pemberdayaan%20Perempuan%2C%20Perlindungan%20Anak%20Dan%20Pemberdayaan%20Masyarakat%20Kota%20Palembang!5e0!3m2!1sid!2sid!4v1754187045715!5m2!1sid!2sid" 
    width="100%" 
    height="450" 
    style="border:0;" 
    allowfullscreen="" 
    loading="lazy" 
    referrerpolicy="no-referrer-when-downgrade">
  </iframe>
</div>

                <div class="absolute top-4 right-4 flex flex-col space-y-2">
                    <button class="bg-white p-3 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                        <div class="w-5 h-5 flex items-center justify-center">
                            <i class="ri-add-line text-gray-700"></i>
                        </div>
                    </button>
                    <button class="bg-white p-3 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                        <div class="w-5 h-5 flex items-center justify-center">
                            <i class="ri-subtract-line text-gray-700"></i>
                        </div>
                    </button>
                    <button class="bg-white p-3 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                        <div class="w-5 h-5 flex items-center justify-center">
                            <i class="ri-focus-3-line text-gray-700"></i>
                        </div>
                    </button>
                </div>
                <div class="absolute bottom-4 right-4 flex space-x-2">
                   <button id="btn-lokasi-saya" class="bg-white px-4 py-2 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center space-x-2">
                        <div class="w-4 h-4 flex items-center justify-center">
                            <i class="ri-navigation-line text-gray-700 text-sm"></i>
                        </div>
                        <span class="text-sm text-gray-700">Lokasi Saya</span>
                    </button>
                    <button class="bg-white px-4 py-2 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center space-x-2">
                        <div class="w-4 h-4 flex items-center justify-center">
                            <i class="ri-share-line text-gray-700 text-sm"></i>
                        </div>
                        <span class="text-sm text-gray-700">Bagikan</span>
                    </button>
                </div>
                <div id="location-popup" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-xl shadow-xl p-6 max-w-sm w-96 hidden">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-4 h-4 bg-primary rounded-full flex-shrink-0"></div>
                            <h3 class="font-semibold text-gray-900">DP3APM Kota Palembang</h3>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600" onclick="document.getElementById('location-popup').classList.add('hidden')">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="ri-close-line"></i>
                            </div>
                        </button>
                    </div>
                    <div class="space-y-3 mb-6">
                        <div class="flex items-start space-x-3">
                            <div class="w-4 h-4 flex items-center justify-center mt-0.5">
                                <i class="ri-map-pin-line text-gray-500 text-sm"></i>
                            </div>
                            <p class="text-sm text-gray-600">Jl. Demang Lebar Daun No.2B, Lorok Pakjo, Kec. Ilir Bar. I, Kota Palembang, Sumatera Selatan 30137</p>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="w-4 h-4 flex items-center justify-center">
                                <i class="ri-time-line text-gray-500 text-sm"></i>
                            </div>
                            <p class="text-sm text-gray-600">Senin - Jumat: 08:00 - 16:00</p>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="w-4 h-4 flex items-center justify-center">
                                <i class="ri-phone-line text-gray-500 text-sm"></i>
                            </div>
                            <p class="text-sm text-gray-600">(0711) 357007</p>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="w-4 h-4 flex items-center justify-center">
                                <i class="ri-road-map-line text-gray-500 text-sm"></i>
                            </div>
                            <p class="text-sm text-gray-600">1.5 km â€¢ 5 menit berkendara</p>
                        </div>
                    </div>
                    <div class="flex space-x-3">
                        <button class="flex-1 bg-primary text-white py-3 px-4 !rounded-button text-sm font-medium hover:bg-red-700 transition-colors whitespace-nowrap flex items-center justify-center space-x-2">
                            <i class="ri-navigation-line"></i>
                            <span>Petunjuk Arah</span>
                        </button>
                        <button class="flex-1 border border-gray-300 text-gray-700 py-3 px-4 !rounded-button text-sm font-medium hover:bg-gray-50 transition-colors whitespace-nowrap flex items-center justify-center space-x-2">
                            <i class="ri-phone-line"></i>
                            <span>Hubungi</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script id="filter-functionality">
        document.addEventListener('DOMContentLoaded', function() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const rangeSlider = document.querySelector('input[type="range"]');
            const radiusValue = document.getElementById('radius-value');
            
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const checkIcon = this.nextElementSibling.querySelector('i');
                    if (this.checked) {
                        checkIcon.style.opacity = '1';
                    } else {
                        checkIcon.style.opacity = '0';
                    }
                });
            });
            
            rangeSlider.addEventListener('input', function() {
                radiusValue.textContent = this.value + ' km';
            });
        });
    </script>
    <script id="emergency-button">
        document.addEventListener('DOMContentLoaded', function() {
            const emergencyButton = document.querySelector('.bg-primary.text-white');
            emergencyButton.addEventListener('click', function() {
                if (confirm('Anda akan dihubungkan ke layanan darurat. Lanjutkan?')) {
                    window.location.href = 'tel:110';
                }
            });
        });
    </script>
</body>
</html>